namespace CGAL {

/*!

\mainpage User Manual
\anchor Chapter_Kinetic_Shape_Partition
\cgalAutoToc

\authors Sven Oesau, Florent Lafarge, Dmitry Anisimov and Simon Giraudot

\section Ksp_introduction Introduction

This \cgal component implements the kinetic shape partition proposed by Bauchet et. al \cgalCite{bauchet2020kinetic}. It takes as input a set of planar shapes, e.g. polygons, and partitions the bounding box of the input into polyhedra, where each polyhedron and its facets are convex. Each facet of the partition is part of the 2D convex hull of an input polygon or an extension of it.

The kinetic partition homogeneously expands the convex hull of each input polygon until collisions occur between them. At each collision, their expansion may stop, they may restrict the propagation along an intersection line or they may continue beyond the intersection line. The polygons are split at the start of the partition and at each collision along the intersection line to be intersection-free.

Whether a polygon is expanded beyond an intersection with another polygon, depends on the user specified `k` parameter. Choosing `k = 1` will cause the expansion of polygons to locally stop at the first intersection with another polygon and choosing `k` equal to the number of input planes will lead to a full expansion of each polygon to the bounding box.

\section Ksp_algorithm Algorithm
The first step of the method creates an intersection graph of the planes of the input polygons. Input polygons that are coplanar are merged into their convex hull.
The intersection graph contains all points and lines of the intersections between the planes and the bounding box. For each support plane, i.e., the plane of an input polygon, all intersections with the bounding box and other support planes are given by lines edges and vertices of the graph. The kinetic partition created in the second step is a subset of faces of the intersection graph depending on the `k` parameter.

\cgalFigureBegin{Ksp_introductionfig,intersection_graph.png}
Intersection graph.\n
Left: 4 polygons as input. Right: intersection graph of polygons and bounding box together with input.
\cgalFigureEnd

The kinetic partition for a chosen `k` is obtained by propagating each polygon within its support plane. As intersections with other polygons can only occur at the known edges in the intersection graph, the 3D collision problem can be solved as separate 2D polygon edge collisions.

\cgalFigureBegin{Ksp_algorithmfig,k_variation.png}
Impact of `k` parameter on partition.\n
Left: Intersection graph with 4 input polygons. Right: three columns with propagated polygons on top and volumes of kinetic partition on bottom for `k` = 1, `k` = 2 and `k` = 3 from left to right with 5, 8 and 12 created volumes respectively.
\cgalFigureEnd

\subsection Ksp_parameters Parameters

The algorithm has five parameters:

- `k`:
The main parameter of this method is `k`, the maximum number of intersections that can occur for a polygon before its expansion stops. The initial intersections of the original input polygons are not considered. Thus increasing the `k` leads to a higher complexity of the partitioning, i.e., a higher number of facets and a higher number of volumes. For a certain `k` the partition can be considered to be complete and an increase in `k` will not further increase the complexity of the partition.

- `reorient_bbox`:
The default bounding box of the partition is axis-aligned. Setting `reorient_bbox` to true aligns the x-axis of the bounding box with the direction of the largest variation in horizontal direction of the input data.

- `bbox_dilation_ratio`:
By default the size bounding box of the input data is increased by 10% to avoid that input polygons are coplanar with the sides of the bounding box.

- `angle_tolerance` and `distance_tolerance`:
The input polygons can be clustered to reduce the number of very thin and very small cells. Two polygons are clustered into one if the deviation between their plane normals is below `angle_tolerance` and the maximum distance of one polygons centroid to the others plane is less than `distance_tolerance`. The default values are 5 degrees for the `angle_tolerance` and a distance of 0.5 for `distance_tolerance`.

\section Ksp_result Result
The kinetic partition can be accessed as a `LinearCellComplex` via `CGAL::Kinetic_shape_partition_3::get_linear_cell_complex()`.

\subsection Ksp_examples Examples

The following example reads a set of polygons from a file and creates a kinetic partition. Increasing the `k` parameter to 2 or 3 leads to a more detailed kinetic partition. Increasing beyond 3 does not lead to more volumes as there are only few input polygons.

\cgalExample{Kinetic_shape_reconstruction/kinetic_precomputed_shapes.cpp}

*/

} /* namespace CGAL */
